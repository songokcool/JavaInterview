## 垃圾收集

&emsp;&emsp;Java的垃圾收集主要是针对Java堆和方法区。

### 1.对象死亡判定

#### 1.1 引用计数法

&emsp;&emsp;在对象中添加一个引用计数器，每当有一个地方引用它时，，计数器值就加一；当引用失效时，计数器值就减一；任何时刻计数器为零的对象就是不可再被使用的。但是，引用计数器不能解决对象之间相互依循环引用的问题。

#### 1.2 可达性分析

&emsp;&emsp;这个算法的基本思路就是通过一系列称为“GC Roots”的根对象作为起始点集，从这些节点开始，根据引用关系向下搜索，搜索过程所走过的路径称为“引用链”，如果某个对象到GC Roots间没有任何引用链相连，或者说从GC Roots到这个对象不可达时，说明此对象是不可能再被使用的。

&emsp;&emsp;在Java中，固定可作为GC Roots的对象包括以下几种：

* 在虚拟机栈（栈帧中的本地变量表）中引用的对象，比如各个线程被调用的方法堆栈中使用的参数、局部变量、临时变量等。
* 在方法区中类静态属性引用的对象，比如Java类的引用类型静态变量。
* 在方法区中常量引用的对象，比如字符串常量池（String Table）里的引用。
* 在本地方法栈中JNI（通常所说的Native方法）引用的对象。
* Java虚拟机内部的引用，如基本数据类型对应的Class对象，一些常驻的异常对象（比如NullPointException、OutOfMemoryError）等，还有系统类加载器。
* 所有被同步锁（synchronize关键字）持有的对象。
* 反应Java虚拟机内部情况的JMXBean、JVMTI中注册的回调、本地代码缓存等。

&emsp;&emsp;除了这些固定的GC Roots集合以外，根据用户所选用的垃圾收集器以及当前回收的内存区域不同，还可以有其他对象“临时性”地加入，共同构成完整的GC Roots集合。

#### 1.3 对象引用

